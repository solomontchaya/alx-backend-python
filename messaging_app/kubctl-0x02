#!/bin/bash
set -e

echo "ğŸš€ Deploying Blue and Green versions of Django app..."
kubectl apply -f blue_deployment.yaml
kubectl apply -f green_deployment.yaml

echo "ğŸ”„ Applying shared service..."
kubectl apply -f kubeservice.yaml

echo "â³ Waiting for pods to start..."
sleep 10
kubectl get pods -l app=django-messaging

echo "ğŸ“‹ Checking logs for the green deployment..."
GREEN_POD=$(kubectl get pods -l version=green -o jsonpath='{.items[0].metadata.name}')
kubectl logs $GREEN_POD

echo "âœ… Blue-Green Deployment Applied Successfully!"
